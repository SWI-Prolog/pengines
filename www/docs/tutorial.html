<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <title>Pengine</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">
        <!-- Bootstrap core CSS -->
        <link href="../vendor/bootstrap3/css/bootstrap.min.css" rel="stylesheet">
        <!-- Documentation extras -->
        <link href="manual_files/docs.css" rel="stylesheet">
        <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
        <script src="assets/js/html5shiv.js"></script>
        <![endif]-->
        <!-- Le fav and touch icons -->
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://twitter.github.io/bootstrap/assets/ico/apple-touch-icon-144-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://twitter.github.io/bootstrap/assets/ico/apple-touch-icon-114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://twitter.github.io/bootstrap/assets/ico/apple-touch-icon-72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="http://twitter.github.io/bootstrap/assets/ico/apple-touch-icon-57-precomposed.png">
        <link rel="shortcut icon" href="http://twitter.github.io/bootstrap/assets/ico/favicon.png">
        <style>
            li.L0, li.L1, li.L2, li.L3,
            li.L5, li.L6, li.L7, li.L8
            { list-style-type: decimal !important }
            h3 {
                margin-top: 40px;
            }
            h4 {
                margin-top: 30px;
            }
            label {
                font-weight: bold;
            }
            code {
                color: black;
            }
            dd {
                margin-left: 30px;
            }
        </style>
        <style id="holderjs-style" type="text/css">.holderjs-fluid {font-size:16px;font-weight:bold;text-align:center;font-family:sans-serif;margin:0}</style>
    </head>
    <body data-twttr-rendered="true" data-spy="scroll" data-target=".bs-docs-sidebar">

        <header class="navbar navbar-inverse navbar-fixed-top bs-docs-nav">
            <div class="container">
                <div class="navbar-header">
                  <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                  </button>
                    <a href="/docs/index.html" class="navbar-brand">Pengine</a>
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li>
                            <a href="/docs/getting_started.html">Getting started</a>
                        </li>
                        <li>
                            <a href="/docs/documentation.html">Documentation</a>
                        </li>
                        <li class="active">
                            <a href="/docs/tutorial.html">Tutorial</a>
                        </li>
                        <li>
                            <a href="/apps/scratchpad/index.html">Scratchpad</a>
                        </li>
                        <li>
                            <a href="/apps/swish/index.html">SWISH</a>
                        </li>
                        <li>
                            <a href="/admin">Administrator</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>
        
        <div class="bs-header" id="content">
            <div class="container">
                <h1>Tutorial</h1>
                <p>A live tutorial teaching you all there is to know about the JavaScript API, the built-in Pengine Prolog predicates, and how to build a Pengine web app from scratch</p>
            </div>
        </div>
        
        <div class="container bs-docs-container">
            <div class="row">
                <div class="col-md-3">
                    <div class="bs-sidebar hidden-print affix-top">
                        <ul class="nav bs-sidenav">
                            <li class="active"><a href="#use">About this tutorial</a></li>
                            <li>
                                <a href="#javascript-api">Using the JavaScript API</a>
                                <ul class="nav">
                                    <li><a href="#queries-and-answers">Queries and answers</a></li>
                                    <li><a href="#error-handling">Error handling</a></li>
                                    <li><a href="#json-mapping">Mapping terms into JSON</a></li>
                                    <li><a href="#top-level">Prolog top-level</a></li>
                                    <li><a href="#loading-and-listing">Loading and listing</a></li>
                                    <li><a href="#input-and-output">Input and output</a></li>
    <!--                            <li><a href="#fetch-and-delegate">Fetching and delegating</a></li>-->
                                    <li><a href="#abort-and-timeout">Abort and timeout</a></li>
                                    <li><a href="#top-evel-extended">Top-level extended</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#new-app">Building Pengine apps</a>
                                <ul class="nav">
                                    <li><a href="#preliminaries">Preliminaries</a></li>
                                    <li><a href="#apps_directory">The files app</a></li>
                                    <li><a href="#queens">The queens app</a></li>
                                    <li><a href="#swish-example">The SWISH app</a></li>
                                </ul>
                            </li>
                            <li><a href="#more-prolog-docs">Prolog books and tutorials</a></li>
                            <!--<li><a href="#tips-and-tricks">Tips and tricks</a></li>-->
                        </ul>
                    </div>
                </div>
                
                <div class="col-md-9">

                    <!-- API overview
                        ================================================== -->
                    <div class="bs-docs-section">
                        <div class="page-header">
                            <h1 id="use">About this tutorial</h1>
                        </div>
                        
                        <p>This is a tutorial dedicated to the fostering of exploration, understanding, and enjoyment of various aspects of the Pengine platform. It tries to address <em>both</em> Prolog programmers <em>and</em> JavaScript developers, but concentrates on the latter group. As a service to Prolog programmers, paragraphs marked with <span class="label label-success">Prolog</span> deal with things that they are likely to already know and can safely skip, but that may be of value to JavaScript programmers. Still, this is not a Prolog tutorial and, in fact, some of the example code used in here is frowned upon by seasoned Prolog programmers. See the section on <a href="#more-prolog-docs">Prolog books and tutorials</a> for a comprehensive list of material useful if you are not at all familiar with Prolog, or need to freshen up your knowledge.</p>

                        <p>This is a <em>live</em> tutorial. It is of course developed using Pengine, that is what has given it life. [Note to myself: Clean up the HTML and the JavaScript and make the tutorial an example, or maybe just a part of it?]. </p>
                        
                        <p><span class="label label-warning">Warning!</span> If testing a particular live example produces an unexpected result, it doesn't necessarilý mean that it is broken. Until certain problems having to do in particular with session timeouts have been sorted, we suggest that you smile and reload and try again!</p>

                        <p><span class="label label-warning">Warning!</span> This application has not been tested in Internet Explorer. It may or may not work as it should there.</p>
                                                
                    </div>


                    <!-- Basic usage
                        ================================================== -->
                    <div class="bs-docs-section">
                        <div class="page-header">
                            <h1 id="javascript-api">Using the JavaScript API</h1>
                        </div>
                        
                        Central to the Pengine platform is a tiny but rich JavaScript library wrapping a set of web API:s for access to the Prolog programming language from web clients. This part of the tutorial deals specifically with that API. 
                        
                        <h3 id="queries-and-answers">Queries and answers</h3>
                        
                        <p>Before we do anything else, we need to create an instance of the Pengine object. This can be done at page load time, and normally has to be done only once. Let's do that, and let's install an <code>onanswer</code> callback function so that we can watch the result of solving the query <code>length([a, b, c], N)</code>. </p>
                        <pre class="prettyprint linenums">
var pengine = new Pengine({
    onanswer: console.log
})

pengine.query("length([a, b, c], N)");
</pre>

                        <h4>Live example</h4>
                        <p>Clicking the Run button below should fill the area underneath with the JSON text corresponding to the JavaScript object representing the answer to our query.</p>
                        <div class="btn-group" style="border: solid black; border-width: 1px 1px 0 1px; padding: 8px;">
                            <button class="btn btn-sm btn-primary" onclick="clear_pre('basic_ask'); basic_query();">Run</button>
                            <button class="btn btn-info btn-sm" onclick="clear_pre('basic_ask')">Clear</button>
                        </div>
                        <div style="border: 1px solid black; padding: 6px">
                            <label>Console log output</label>
                            <pre class="prettyprint pre-scrollable" id="basic_ask"></pre>
                        </div>
                        <p></p>
                        <p>The value of the <code>event</code> property is <code>answer</code> and that is what triggered the <code>onanswer</code> handler in the first place. The <code>data</code> property is more complex: The value <code>true</code> of the <code>success</code> property shows that the query succeeded. The value of the <code>bindings</code> property is an object containing a property <code>"N"=3</code>. The "N" here is the Prolog variable in the query. The value <code>false</code> of the <code>more</code> property shows that we should not expect more solutions. Finally, the value of the <code>time</code> property shows how long time (CPU time in seconds) it took to execute the query on the server.</p>
                        <p>To have Pegine solve a more interesting query, such as <code>append(A, B, [a, b, c])</code> with its four different solutions, we need to call the <code>query()</code> method first, and then the <code>next()</code> method in order to see the other solutions. Calling the <code>stop()</code> method will stop the interaction.</p>
                        <pre class="prettyprint linenums">
pengine.query("append(A, B, [a, b, c])");
pengine.next();
pengine.stop();
</pre>
                        <p><span class="label label-success">Prolog</span> This use of <code>append/3</code> may look strange for people new to Prolog. The thing is that many Prolog predicates can be used in more than one <em>direction</em>. In this case, we are not using <code>append/3</code> to concatenate two lists, but to split a list up into two parts. This can be done in more than one way, and Prolog is able to find them all.</p>
                        <h4>Live example</h4>
                        <p>Again, clicking the First button below should fill the area underneath with the JSON text corresponding to the JavaScript object representing the first answer to our query. Clicking the Next button will trigger the search for more solutions.</p>
                        <div class="btn-group" style="border: solid black; border-width: 1px 1px 0 1px; padding: 8px;">
                            <button class="btn btn-sm btn-primary" onclick="clear_pre('basic_ask2'); basic_ask2();">First</button>
                            <button class="btn btn-sm btn-success" onclick="pengine.next();">Next</button>
                            <button class="btn btn-sm btn-warning" onclick="pengine.stop();">Stop</button>
                            <button class="btn btn-info btn-sm" onclick="clear_pre('basic_ask2')">Clear</button>
                        </div>
                        <div style="border: 1px solid black; padding: 6px">
                            <label>Console log output</label>
                            <pre class="prettyprint pre-scrollable" id="basic_ask2"></pre>
                        </div>
                        <p></p>

                        <p><span class="label label-success">Prolog</span> If you clicked the First button and then the Next button four times in a row, you may have noticed something of a contradiction. The <code>more</code> property in the JSON corresponding to the second to last answer had the value <code>true</code>, yet the last answer shows, quite correctly, that there were no more solutions. This is the way it works in Prolog. Whereas <code>"more": false</code> guarantees that there are no more solutions, <code>"more": true</code> only means that there <em>may</em> be more solutions, but does not guarantee anything. </p>

                    <!-- Error handling
                        ================================================== -->
                        
                        <h3 id="error-handling">Error handling</h3>
                        
                        <p>If we want the client to be notified about any errors that occur on the server side we need to define an error handler.</p>
                        <pre class="prettyprint linenums">
var pengine = new Pengine({
    onanswer: handleAnswer,
    onerror: handleError
})
</pre>
<p>How this works will be demonstrated in some of the examples below.</p>


                    <!-- Mapping terms into JSON
                        ================================================== -->

                        <h3 id="json-mapping">Mapping terms into JSON</h3>
                        
                        <p>A programmer using Pengine needs to understand how terms are converted into JSON. The mapping of Prolog terms into JSON structures are defined in the <a href="/docs/documentation.html#json-mapping">documentation</a>, so here it suffices to give a live example that allows you to explore how it works in practice. </p>

                        <h4>Live example</h4>
                        <p>Enter a Prolog term in the text field below, click the Convert button, and watch the term converted into JSON.</p>
                        <div class="btn-group" style="border: solid black; border-width: 1px 1px 0 1px; padding: 8px;">
                            <label>Prolog term:
                            <input style="width:350px;font-size:105%" id="term-input" class="input-sm" value="foo(bar(a, b), 1, 3.14, true, @true)">
                            <button class="btn btn-sm btn-primary" onclick="clear_pre('json-converted'); json_convert();">Convert</button></label>

                        </div>
                        <div style="border: 1px solid black; padding: 6px">
                            <label>JSON representation</label>
                            <pre class="prettyprint pre-scrollable" id="json-converted"></pre>
                        </div>


                    <!-- Prolog top-level
                        ================================================== -->
                        
                        <h3 id="top-level">Prolog top-level</h3>
                        
                        <p>Now, given what we have learned so far, let us exercise the Pengine API a bit more. With the help of the browser's built in <code>alert()</code>, <code>confirm()</code> and <code>prompt()</code> dialog widgets we can write JavaScript code that implements a fully functional Prolog top-level. Things like error reporting and I/O is missing in this version, but that will be fixed in the next version.</p>

                        <pre class="prettyprint linenums">
/* A minimal Prolog top-level.
   Call function prolog() to start.
*/

function prolog() {
    function handleAnswer() {
        if (this.data.success) {
            var bindings = JSON.stringify(this.data.bindings);
            if (window.confirm(bindings)) {
                if (this.data.more) {
                    pengine.next();
                }
            } else {
                pengine.stop();
            }
        } else {
            window.alert("false");
        }
    }
    pengine = new Pengine({
        onanswer: handleAnswer
    });
    query();
}

function query() {
    if (q = window.prompt("Enter a Prolog query")) {
        pengine.query(q);
    }
}
</pre>

                        <h4>Live example</h4>

                        <p>Click the Run button below in order to run this example. We have prepared the first dialogue with a suggestion for a query but you may try other if you want. Click the OK button in the query dialogue to see the first solution to your query, and the Ok button in subsequent dialogues to see the remaining solutions. Clicking the Cancel button at any point stops the interaction.</p>
                        
                        <div class="btn-group" style="border: solid black; border-width: 1px 1px 0 1px; padding: 8px;">
                            <button class="btn btn-sm btn-primary" onclick="clear_pre('prolog'); prolog();">Run</button>
                            <button class="btn btn-info btn-sm" onclick="clear_pre('prolog')">Clear</button>
                        </div>
                        <div style="border: 1px solid black; padding: 6px">
                            <label>Console log output</label>
                            <pre class="prettyprint pre-scrollable" id="prolog"></pre>
                        </div>                        
                        
                        <p></p>
                        <p>A word about the use of <code>alert()</code>, <code>confirm()</code> and <code>prompt()</code> dialog widgets. As you probably noticed when running the above example they are all modal. This means, among other things, that when they are shown, JavaScript execution grinds to a halt, and the page will no longer be responsive. Besides, they a kind of ugly looking so normally you don't want to use them in a real application. For another approach to the implementation of a "Web Prolog", see the example with that name in the <a href="/apps/scratchpad/index.html">Pengine Scratchpad</a>.</p>                        
                                            
                    
                    <!-- Loading and listing
                        ================================================== -->
                        
                        <h3 id="loading-and-listing">Loading and listing</h3>
                        
                        <p>Loading a program is easy. And once you have loaded your program you can check that it's there by doing a listing. </p>
                        <pre class="prettyprint linenums">
var pengine = new Pengine({
    onload: console.log,
    onlist: console.log,
    onerror: console.log
})

pengine.load(program)
pengine.listing()
</pre>

                        <h4>Live example</h4>
                        
                        <p>Click the Load button in order to load the program in the text area underneath, and the Listing button to check that it ended up all-right. You may also want to introduce errors in the program and study what happens when you try to load it.</p>

                        <div class="btn-group" style="border: solid black; border-width: 1px 1px 0 1px; padding: 8px;">
                            <button class="btn btn-sm btn-primary" onclick="clear_pre('load-console'); load();">Load</button>
                            <button class="btn btn-sm btn-primary" onclick="clear_pre('load-console'); listing();">Listing</button>
                            <button class="btn btn-info btn-sm" onclick="clear_pre('prolog2');clear_pre('load-console')">Clear</button>
                        </div>
                        <div style="border: 1px solid black; padding: 6px">
                            <label>Program (to be loaded)</label>
                            <textarea rows="6" style="width:97%" id="load">
loves(vincent, mia).
loves(marcellus, mia).
loves(pumpkin, honey_bunny).
loves(honey_bunny, pumpkin).

jealous(X, Y) :- loves(X, Z), loves(Y, Z).
</textarea>
                            <label>Console log output</label>
                            <pre class="prettyprint pre-scrollable" id="load-console"></pre>
                        </div>                        
                                            
                    <!-- Input and output
                        ================================================== -->

                        <h3 id="input-and-output">Input and output</h3>
                        
                        <h4>Output</h4>
                        
                        <p>Full-blown Prolog systems such as SWI-Prolog supports a large number of predicates dedicated to the task of formatting and outputting data, such as <code>write</code>, <code>format</code>, <code>put_char</code> and friends. From the point of view of Pengine, they are all more or less irrelevant. Instead, we have introduced a general output predicate called simply <code>output/1</code>. The idea behind this predicate is that it outputs JSON rather than just text. The Pengine way is to do formatting on the client side, on the basis of what appears in the JSON written out to the client by means of <code>output/1</code> or returned in answers to queries.
                        </p>
                        <h4>Live example</h4>
                        <pre class="prettyprint linenums">
var pengine = new Pengine({
    onanswer: console.log,
    onoutput: console.log
})

pengine.query("between(1, 20, N), output(N), N==20");
</pre>
                        <div class="btn-group" style="border: solid black; border-width: 1px 1px 0 1px; padding: 8px;">
                            <button class="btn btn-sm btn-primary" onclick="clear_pre('output'); output();">Run</button>
                            <button class="btn btn-info btn-sm" onclick="clear_pre('output')">Clear</button>
                        </div>
                        <div style="border: 1px solid black; padding: 6px">
                            <label>Console log output</label>
                            <pre class="prettyprint pre-scrollable" id="output"></pre>
                        </div>
                        
                        <h4>Input</h4>
                        
                        <p>Full-blown Prolog systems also support a large number of different predicates for inputting data, such as <code>read</code> and <code>get_char</code> in different variations. In Pengine they too are more or less of no relevance. To take their place, we have introduced a general input predicate called simply <code>input/1</code>. It accepts JSON sent to it by the client. For example, if the client is JavaScript running in the browser, the Pengine JavaScript API method <code>input()</code> accepts a JavaScript object (such as <code>{a:1, b:2}</code>) as an argument, that <code>input/1</code> on the server side of Pengine will translate into a JSON term (such as <code>json([a=1, b=2])</code>).
                        </p>
                        <h4>Live example</h4>
                        <pre class="prettyprint linenums">
var pengine = new Pengine({
    onanswer: console.log,
    onoutput: console.log,
    onprompt: handlePrompt
})

function handlePrompt() {
    console.log(this);
    var string = prompt(this.data);
    pengine.input(string);
}

pengine.query("input(X), output(X)");
</pre>
                        <p></p>
                        <div class="btn-group" style="border: solid black; border-width: 1px 1px 0 1px; padding: 8px;">
                            <button class="btn btn-sm btn-primary" onclick="clear_pre('input-x'); input();">Run</button>
                            <button class="btn btn-info btn-sm" onclick="clear_pre('input-x')">Clear</button>
                        </div>
                        <div style="border: 1px solid black; padding: 6px">
                            <label>Console log output</label>
                            <pre class="prettyprint pre-scrollable" id="input-x"></pre>
                        </div>
                    
 <!--                   <div class="bs-docs-section">
                        <div class="page-header">
                            <h1 id="fetch-and-delegate">Fetching and delegating</h1>
                        </div>
                                                
                        <h2>Fetch</h2>
                        
                        <p>Related to input is a predicate dedicated to the fetching of data from other web-services. It is called <code>fetch()</code> and is related to input i the sense that it is asking an external entity for input, only that this time it is a machine rather than a human being. [NOT YET IMPLEMENTED]
                        </p>
                        
                        <h2>Delegate</h2>
                        <p>The delegation mechanism in Pengine deserves a section of its own. The idea is to introduce a little bit of agent programming and allow remote calls to other Pengine servers. [MORE NEEDED HERE] 
                        </p>
                   
                    </div>
-->     

                    <!-- Abort and timeout
                        ================================================== -->
                        
                        <h3 id="abort-and-timeout">Abort and timeout</h3>
                        
                        <p>This is a good point to demonstrate the effect of the <code>abort()</code> method and the server-set timeout. If the execution of a query hangs due to for example an infinite loop, there are two things we can do: We can either wait for the timeout to kick in, which will happen after about 15 seconds (dependent on the current setting of the server) or we can abort the query by executing the <code>abort()</code> method. The live example below is set up so that you can try it both ways.</p>
                        <h4>Live example</h4>
                        <p>Clicking the Run button will run the engine with a query that in principle would print an infinite number of <code>x</code>:es if we did not do something about it: </p>
                        <pre class="prettyprint linenums">
pengine.query("repeat, output(x), sleep(1), fail");
</pre>
                        <p>Clicking the Abort button will execute the <code>abort()</code> command:</p>
                        <pre class="prettyprint linenums">
pengine.abort();
</pre>
                        <div class="btn-group" style="border: solid black; border-width: 1px 1px 0 1px; padding: 8px;">
                            <button class="btn btn-sm btn-primary" onclick="clear_pre('abort-and-timeout-out'); abort_and_timeout();">Run</button>
                            <button class="btn btn-sm btn-danger" onclick='pengine.abort()'>Abort</button>
                            <button class="btn btn-info btn-sm" onclick="clear_pre('abort-and-timeout-out')">Clear</button>
                        </div>
                        <div style="border: 1px solid black; padding: 6px">
                            <label>Console log output</label>
                            <pre class="prettyprint pre-scrollable" id="abort-and-timeout-out"></pre>
                        </div>

                    <!-- Top-level extended
                        ================================================== -->
                        
                        <h3 id="top-evel-extended">Top-level extended</h3>
                        
                        <p>Now, here's a new version of our Prolog top-level loop. Error reporting and I/O have now been fixed. All possible handlers have been defined and all possible methods except <code>abort()</code> have been used.</p>
                        <pre class="prettyprint linenums">
/* A more complete Prolog top-level loop.
   Call function prolog() to start.
*/

function prolog() {
    function handleLoaded() {
        if (q = prompt("Enter a Prolog query")) {
            pengine.query(q);
        }
    }
    function handleAnswer() {
        if (this.data.success) {
            var bindings = JSON.stringify(this.data.bindings);
            if (confirm(bindings)) {
                if (this.data.more) {
                    pengine.next();
                }
            } else {
                pengine.stop();
            }
        } else {
            alert("false");
        }
    }
    function handlePrompt() {
        if (str = prompt(this.data)) {
            pengine.input(str);
        }
    }
    function handleError() {
        alert("Error: " + this.data);
    }
    pengine = new Pengine({
        onload: handleLoaded,
        onanswer: handleAnswer,
        onoutput: function() {write(this, "prolog-output")},
        onerror:  handleError,
        onprompt: handlePrompt,
        onhalted: function() {log(this, "prolog2")}
    });
    var p = document.getElementById("prolog-code").value; 
    pengine.load(p);
}
</pre>

                        <h4>Live example</h4>
                        <p>As before, you run this example by clicking the Run button and enter your query in the widget that appears. We have also prepared a number of ready formulated queries for you, some of which give rise to errors:</p>
                        <ul>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('loves(X, mia)')">loves(X, mia)</a>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('jealous(X, Y)')">jealous(X, Y)</a>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('length([a, b, c], N)')">length([a, b, c], N)</a>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('append(A,B,[1, 2, 3])')">append(A,B,[1,2,3])</a>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('between(1, 10, N), output(N), N==10')">between(1, 10, N), output(N), N==10</a>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('(input(X, 3) -> output(X); output(timeout))')">(input(X, 3) -> output(X); output(timeout))</a>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('repeat, input(X), output(X), X == stop')">repeat, input(X), output(X), X == stop</a>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('set_prompt(json([a=1,b=2])), input(X)')">set_prompt(json([a=1,b=2])), input(X)</a>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('delegate(\'http://swish.spyderbrain.com:5003\',member(A, [1,2,3]))')">delegate('http://swish.spyderbrain.com:5003',member(A, [1,2,3]))</a>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('syntax_error(')">syntax_error(a,</a> &nbsp;&nbsp;<em>(Should raise a syntax error)</em>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('length(3, A)')">length(3, A)</a> &nbsp;&nbsp;<em>(Should raise a type error)</em>
                            <li><a href="#" onclick="clear_pre('prolog2');clear_pre('prolog-output');prolog2('pwd')">pwd</a> &nbsp;&nbsp;<em>(Should raise a permission error)</em>
                        </ul>
                        <div class="btn-group" style="border: solid black; border-width: 1px 1px 0 1px; padding: 8px;">
                            <button class="btn btn-sm btn-primary" onclick="clear_pre('prolog2');clear_pre('prolog-output'); prolog2('');">Run</button>
                            <button class="btn btn-sm btn-danger" onclick="pengine.abort();">Abort</button>
                            <button class="btn btn-info btn-sm" onclick="clear_pre('prolog2');clear_pre('prolog-output')">Clear</button>
                        </div>
                        <div style="border: 1px solid black; padding: 6px">
                            <label>Program (to be loaded)</label>
                            <textarea rows="6" style="width:97%" id="prolog-code">
loves(vincent, mia).
loves(marcellus, mia).
loves(pumpkin, honey_bunny).
loves(honey_bunny, pumpkin).

jealous(X, Y) :- loves(X, Z), loves(Y, Z).
</textarea>
                            <label>Prolog output</label>
                            <pre class="pre-scrollable" id="prolog-output"></pre>
                            <label>Console log output</label>
                            <pre class="prettyprint pre-scrollable" id="prolog2"></pre>
                        </div>
                    </div>
                    
                    <!-- Building Pengine apps
                        ================================================== -->
                    <div class="bs-docs-section">
                        <div class="page-header">
                            <h1 id="new-app">Building Pengine apps</h1>
                        </div>
                        
                        <h3 id="preliminaries">Preliminaries</h3>

                        <h4>The apps directory</h4>
                        
                        <p>Pengine apps are written in a combination of Prolog, HTML, CSS and JavaScript. The current version of the Pengine platform tries to enforce a bit of dicipline on how apps should be built by insisting that the source code of an app be placed in a dedicated directory inside the <em>apps directory</em> located in the root directory of the distribution. </p>

                        <p>In this section we will demonstrate how this works by looking closely at three applications present in the apps directory of the Pengine distribution. Part of this directory has the following content:</p>
                        <div class="highlight">
                            <pre><code class="bash">apps/
├── files/
├── ├── index.pl
├── queens/
├── ├── index.html
├── ├── img/
├── ├── ├── queen.png
├── swish/
├── ├── index.pl
├── ├── index.html
├── ├── css/
├── ├── ├── swish.css
├── ├── img/
├── ├── ├── swish.png
├── ├── js/
├── ├── ├── swish.js
</code></pre>
                        </div>

                        <h4>Where does the Prolog code come from?</h4>
                                         
                        <p>A Pengine app can be given access to the Prolog code on which it relies using (possibly a combination of) three different methods:</p>
                        
                        <ol>
                            <li>By storing Prolog code in its app directory and to provide access only to a (usually small) set of predicates exported by a module defined in its <code>index.pl</code> file.</li>
                            <li>By inlining Prolog code in the its HTML document.</li>
                            <li>By allowing its users to load and query arbitrary but dynamically safety checked Prolog code.</li>
                        </ol>

                        <p>The choice of method(s) has consequences for the <em>safety</em> and for the generality of the programs that can safely be accessed in this way. The safety of 1) depends entirely on the safety of the exported predicates. The exported predicates can in turn and without problems be defined in terms of predicates that are <em>not</em> safe, i.e. they can access the filesystem, add or delete files, execute programs and perform other OS tasks. As long as the author of the application doesn't give such harmful capabilities to the exported predicates, at least not in an unrestricted way, the application as a whole is safe. The safety of 2) and 3) hinges on the fact that only a <em>restricted</em> set of predicates can be used in this way. This set is determined by <code>library(sandbox)</code>.</p>

                        <h4>The index.pl file</h4>
                        <p>The file index.pl provides the app which it serves with a clean and safe interface to a number of predicates necessary for the it to function as intended. As explained above, this file may contain almost any Prolog code, without any restrictions. However, two things about file are important: 1) It must be a <em>module file</em>, i.e. it must be headed by a module declaration stating the name and the arity of the predicates exported by the module, and 2) the exported predicates must be <em>safe</em>.</p>

                        <p>Whereas the first condition is easy to check, the second is harder. What does it mean for a particular predicate to be safe? Well, Prolog is a full-featured programming language, complete with predicates providing access to the OS and the file system on the machine on which it s running, making it easy to write programs that can harm your computer. A safe predicate is a predicate that can be called without risk of doing that. Looks complicated and maybe therefore also risky? Fortunately, and as we shall see, the Pengine Admin GUI provides us with the means to help us determine the safety of a predicate. [MORE HERE...]</p>                                                

                        <h3 id="apps_directory">The files app</h3>
                        
                        <p>[To be written]</p>
<!--
                        <p>The directory of the <em>family</em> app contains a file <code>index.pl</code>. Since it doesn't contain any HTML files we can assume that the purpose of it is to act as a web service, serving family data encoded as JSON in response to requests being thrown at it. No HTML means no GUI, at least no GUI that we necessarily know anything about.</p>
                        
                        <p>To be a <em>web app</em>, the directory must contain at least an HTML document <code>index.html</code>. The app may still be partly written in Prolog, but then the Prolog code is inlined in the HTML document. If no HTML document is present, then the directory may contain a Prolog file named <code>index.pl</code>. Then this is probably a Prolog <em>web service</em>, an application dedicated to the task of dealing with queries thrown at it and returning answers in the form of JSON to any client that wants it.</p>
                     

                        <p>Let us now look closer at the <code>index.pl</code> file of the queens application:</p>
                        
                        <div class="highlight">
                            <pre><code class="bash">:- module(queens, 
        [   queens/2
        ]).

queens(N, Queens) :-
    length(Queens, N),
    board(Queens, Board, 0, N, _, _),
    queens(Board, 0, Queens).

board([], [], N, N, _, _).
board([_|Queens], [Col-Vars|Board], Col0, N, [_|VR], VC) :-
    Col is Col0+1,
    functor(Vars, f, N),
    constraints(N, Vars, VR, VC),
    board(Queens, Board, Col, N, VR, [_|VC]).

constraints(0, _, _, _) :- !.
constraints(N, Row, [R|Rs], [C|Cs]) :-
    arg(N, Row, R-C),
    M is N-1,
    constraints(M, Row, Rs, Cs).

queens([], _, []).
queens([C|Cs], Row0, [Col|Solution]) :-
    Row is Row0+1,
    select(Col-Vars, [C|Cs], Board),
    arg(Row, Vars, Row-Row),
    queens(Board, Row, Solution).
</code></pre>
                        </div>

<p>As a consequence of placing this <code>index.pl</code> file in the directory <code>queens</code> directly below the apps directory, the application will show up on the Apps settings page:</p>

                        <img src="manual_files/queens_app_unloaded.jpg" alt="..." class="img-rounded">
                        
<p>The module isn't loaded yet, but if we click the Load button it will load and the relevant area of the Apps settings page will show that it is also deemed safe by the Pengine platform.</p>                    

                        <img src="manual_files/queens_app_loaded.jpg" alt="..." class="img-rounded">

<p>From now on, and until we chose to unload the queens app, the <code>queens/2</code> predicate can be queried by the application. The other predicates cannot be queried since they are not exported by the queens module.</p>  

-->   
                        
                        <h3 id="queens">The queens app</h3>
                        
                        
                        <p>In chess, the queen can move any number of squares in any one direction, vertically, horizontally, or diagonally.  The 8-queens
                        puzzle requires that 8 queens are placed on a chessboard so that no queen can capture any other queen. The Prolog solution to this puzzle is a real classic.</p>

                        <p>This time we are going to build a "real" application, with graphics and all that. What is more, we are going to place all the code necessary in <em>one compound single document</em>, something that has always been possible with a combination of HTML, CSS and JavaScript. The trick here is to place the Prolog source code inside a &lt;script&gt; elements with the type attribute set to "text/x-prolog" rather than the usual "text/javascript". The rest goes automatically, because creating the Pengine object by means of <code>new Pengine(callbacks)</code> will collect the Prolog code and load it. Here is the document: </p>
                                                
                    <pre class="prettyprint linenums">
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;
    &lt;title&gt;Eight Queens Demo&lt;/title&gt;
    &lt;meta name=&quot;author&quot; content=&quot;Torbj&ouml;rn Lager and Jan Wielemaker&quot;&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;/vendor/jquery/jquery-2.0.3.min.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;/assets/js/pengine.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/x-prolog&quot;&gt;
      /*  queens(+N, -Queens) is nondet.
          @author Richard A. O&#x27;Keefe (The Craft of Prolog)
      */
      
      queens(N, Queens) :-
          length(Queens, N),
          board(Queens, Board, 0, N, _, _),
          queens(Board, 0, Queens).
      
      board([], [], N, N, _, _).
      board([_|Queens], [Col-Vars|Board], Col0, N, [_|VR], VC) :-
          Col is Col0+1,
          functor(Vars, f, N),
          constraints(N, Vars, VR, VC),
          board(Queens, Board, Col, N, VR, [_|VC]).
      
      constraints(0, _, _, _) :- !.
      constraints(N, Row, [R|Rs], [C|Cs]) :-
          arg(N, Row, R-C),
          M is N-1,
          constraints(M, Row, Rs, Cs).
      
      queens([], _, []).
      queens([C|Cs], Row0, [Col|Solution]) :-
          Row is Row0+1,
          select(Col-Vars, [C|Cs], Board),
          arg(Row, Vars, Row-Row),
          queens(Board, Row, Solution).
      
    &lt;/script&gt;
    &lt;style type=&quot;text/css&quot; media=&quot;screen&quot;&gt;
      #board {
          width: 400px;
          height: 400px;
          border: 20px groove #630;
      }
      .row {
          width: 100%;
      }
      .square {
          float: left;
      }
      .odd {
          background-color: #E4E4E4;
      }
      .even {
          background-color: #8A4117;
      }
      .square-img {
          width:100%;
          height:100%;
      }
    &lt;/style&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
      var boardsize = 8;
      var boardwidth = 400;
      var pengine = new Pengine({
          onanswer:handleAnswer,
          onerror:handleError
      });
      function board(size, width) {
          var board = &quot;&quot;;
          var fieldsize = Math.floor(width/size);
          for(var i=1; i&lt;=size; i++) {
              board += row(i, size, fieldsize);
          }
          $(&quot;#board&quot;).html(board);
      }
      function row(n, size, fieldsize) {
          var y = fieldsize * (n-1);
          var row = &quot;&lt;div class=&#x27;row&#x27; style=&#x27;top:&quot;+y+&quot;px; left:0px;&#x27;&gt;\n&quot;;
          for ( var i=1; i&lt;=size; i++ ) {
              var id = i+&quot;-&quot;+n;
              var oe = (i+n)%2 == 0 ? &quot;even&quot; : &quot;odd&quot;;
              row += &quot;&lt;div id=&#x27;&quot;+id+&quot;&#x27; class=&#x27;square &quot;+oe +
                 &quot;&#x27; style=&#x27;width:&quot;+fieldsize+&quot;px; height:&quot;+fieldsize+&quot;px&#x27;&gt;&lt;/div&gt;\n&quot;;
          }
          row += &quot;&lt;/div&gt;\n&quot;;
          return row;
      }
      function clearBoard() {
          for (var i = 1; i &lt;= boardsize; i++) {
              for (var j = 1; j &lt;= boardsize; j++) {
                  $(&quot;#&quot;+i+&quot;-&quot;+j).html(&quot;&quot;);
              }
          }
      }
      function setQueens(squareList) {
          for (var i = 1; i &lt;= boardsize; i++) {
              var id = i+&quot;-&quot;+squareList[i-1];
              $(&quot;#&quot;+id).html(&quot;&lt;img src=&#x27;/queens/queen.png&#x27; class=&#x27;square-img&#x27;/&gt;&quot;);
          }
      }
      function handleAnswer() {
          if (this.data.success) {
              clearBoard();
              setQueens(this.data.bindings.Queens);
          } else {
              $(&quot;#msg&quot;).html(&quot;There are no more solutions.&quot;);
          }
      }
      function handleError() {
          $(&quot;#msg&quot;).html(this.data);
      }
      function query() {
          $(&quot;#msg&quot;).html(&quot;&quot;);
          pengine.query(&quot;queens(8, Queens)&quot;);
      }
      function next() {
          pengine.next();            
      }
    &lt;/script&gt;
  &lt;/head&gt;
  &lt;body onload=&quot;board(boardsize, boardwidth)&quot;&gt;
    &lt;center style=&quot;margin-top:20px;&quot;&gt;
      &lt;div id=&quot;board&quot;&gt;&lt;/div&gt;
      &lt;div style=&quot;margin-top:20px;&quot;&gt;
        &lt;button id=&quot;first&quot; onclick=&quot;query()&quot;&gt;First&lt;/button&gt;
        &lt;button id=&quot;next&quot; onclick=&quot;next()&quot;&gt;Next&lt;/button&gt;
        &lt;div style=&quot;margin-top:20px;&quot; id=&quot;msg&quot;&gt;&lt;/div&gt;
      &lt;/div&gt;
    &lt;/center&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
                    
                        <h4>Live example</h4>


                        <p>We run this demo in the &lt;iframe&gt; below. Note that there are no less than 92 solutions to the eight queens problem so it's highly unlikely that you will be able to generate them all before timeout.
                    </p>
                        <iframe style="margin-left: 20px; width:450px; height:500px;" src="/examples/queens/index.html"></iframe>
                    
                    <p></p>
                    <p>The full version of the eight queens program is available as one of the examples in the <a href="/apps/scratchpad/index.html">Pengine Scratchpad</a>. You may want to change a few things, just to see what happens.</p>
                    <p>Note the implication of this: We are doing client-side and server-side programming in a single source code document! We should note, however, that this is not always the recommended way of building web applications. Most front-end developers prefer to keep their HTML, CSS and JavaScript in separate files, presumably to maintain a separation of content, presentation and behavior. </p> 
                    
   
                        <h3 id="swish-example">The <span style="color:darkblue">SWI</span><span style="color:maroon">SH</span> app</h3>                
                              <p>As an example of a much more substantial and potentially quite useful application written on top of the Pengine platform, let us introduce <span style="color:darkblue">SWI</span><span style="color:maroon">SH</span>. <span style="color:darkblue">SWI</span><span style="color:maroon">SH</span> stands for "SWI-Prolog for SHaring". Inspired by web-based tools such as <a target="_blank" href="http://jsfiddle.net/">JSFIDDLE</a>, <span style="color:darkblue">SWI</span><span style="color:maroon">SH</span> allows you to develop a program and then share it with others on the Web. <span style="color:darkblue">SWI</span><span style="color:maroon">SH</span> is available at <a href="http://swish.spyderbrain.com">http://swish.spyderbrain.com</a>.</p>
                    </div>
                                        

                    <!-- API overview
                        ================================================== -->
                    <div class="bs-docs-section">
                        <div class="page-header">
                            <h1 id="more-prolog-docs">Prolog books and tutorials</h1>
                        </div>                    

                        <p>Many books has been written about Prolog, in particular in the 80's and 90's. It may be a sign of an impopular programming language that so many of them now are free and downloadable in the pdf format. In fact, the number of free books are so many that we choose to list only the free ones here.</p>

                        <ul>
                                <li>Patrick Blackburn, Johan Bos, and Kristina Striegnitz.<a href="http://cs.union.edu/~striegnk/learn-prolog-now/lpnpage.php?pageid=online" target="_top"> Learn Prolog Now! An introduction to Prolog programming.</a> Free online version.
                                </li>
                                <li>Michael A. Covington, Donald Nute, and André Vellino. <a href="http://www.covingtoninnovations.com/books/PPID.pdf" target="_top"><em>Prolog Programming in Depth</em></a>, Second edition, Prentice-Hall, 1997.
                                </li>                                
                                <li>Michael A. Covington. <a href="http://www.covingtoninnovations.com/books/NLPPP.pdf" target="_top"><em>Natural Language Processing for Prolog Programmers</em></a>, Prentice-Hall, 1994.
                                </li>
                                <li>Peter Flach, <a href="http://www.cs.bris.ac.uk/~flach/SimplyLogical.html" target="_top"><em>Simply Logical: Intelligent Reasoning by Example</em></a> John Wiley 1994, xvi + 240 pages, ISBN 0471 94152 2.
                                </li>
                                <li>Gerald Gazdar and Chris Mellish. <a href="http://www.informatics.sussex.ac.uk/research/groups/nlp/gazdar/nlp-in-prolog/" target="_top"><em>Natural Language Processing in Prolog</em></a>
                                </li>
                                <li>Dennis Merritt. <a href="http://www.amzi.com/ExpertSystemsInProlog/" target="_top"><em>Building Expert Systems in Prolog</em></a>
                                </li>
                                <li>Dennis Merritt. <a href="http://www.amzi.com/AdventureInProlog/" target="_top"><em>Adventure in Prolog</em></a>
                                </li>
                                <li>Fernando C. N. Pereira and Stuart M. Shieber.<a href="http://mtome.com/Publications/PNLA/pnla.html" target="_top"><em> Prolog and Natural-Language Analysis</em> </a>
                                </li>

                                  
                                
                        </ul>



        </div>

                    
                    
                   <!--  Issues
                        ================================================== -->
<!--
                    <div class="bs-docs-section">
                        <div class="page-header">
                            <h1 id="issues">Issues</h1>
                        </div>
                        <ul>
                            <li>Timeout should probably use cpu-time rather than wall-time. Not yet sure how to implement this but the swi-prolog mailing list conversation "Interest in precise timeouts?" might provide some ideas.</li>
                            <li>Loss of HTTP session forces reload. Can we create a new session when calling first/1?</li>
                            <li>Something strange happens when we click Listing twice in a row....</li>
                            <li>Support <code>&lt;script src="mysrc.pl" type="text/x-prolog"&gt;</code>?</li>

                        </ul>
                    </div>-
                    
                    
          
                     Tips and tricks
                        ================================================== 
                    <section id="tips-and-tricks">
                        <div class="page-header">
                            <h1>Tips and tricks</h1>
                        </div>
                        <p><a href="http://www.swi-prolog.org/pldoc/man?section=jsonconvert">JSON-convert</a></p>
                    </div>
                              
          -->
                </div>
            </div>
        </div>
        <!-- Footer
            ================================================== -->
        <footer class="footer">
            <div class="container">
                <p>Designed and built by Torbjörn Lager.</p>
                <p>Documentation based on Twitter Bootstrap, licenced under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
                <ul class="footer-links">
                </ul>
            </div>
        </footer>


        <!-- Placed at the end of the document so the pages load faster -->
        <script src="../vendor/jquery/jquery-2.0.3.min.js"></script>
        <script type="text/javascript" src="../assets/js/pengine.js"></script>

        <script src="../vendor/bootstrap3/js/bootstrap.min.js"></script>
        <script src="manual_files/widgets.js"></script>
        <script src="manual_files/holder.js"></script>
        <script src="manual_files/application.js"></script>
        
        
        <script>
            var pengine;
            
            function basic_query() {
                pengine = new Pengine({
                    onanswer: function() {log(this, "basic_ask")}
                });
                pengine.query("length([a, b, c], N)");
            }
            
            function basic_ask2() {
                pengine = new Pengine({
                    onanswer: function() {log(this, "basic_ask2")},
                    onhalted: function() {log(this, "basic_ask2")},
                    onerror: function() {log(this, "basic_ask2")}
                });
                pengine.query("append(A, B, [a, b, c])");
            }

            function json_convert() {
                var term = $("#term-input").val();
                pengine = new Pengine({
                    onanswer: function() {
                        log(this.data.bindings.Term, "json-converted")
                    },
                    onerror: function() {log(this, "json-converted")}
                });
                pengine.query("Term = "+ term);
            }            
                     
            function output() {
                pengine = new Pengine({
                    onanswer: function() {log(this, "output")},
                    onoutput: function() {log(this, "output")}
                });
                pengine.query("between(1, 20, N), output(N), N==20");
            }
            
            function abort_and_timeout() {
                pengine = new Pengine({
                    onanswer: function() {log(this, "abort-and-timeout-out")},
                    onoutput: function() {log(this, "abort-and-timeout-out")},
                    onerror:  function() {log(this, "abort-and-timeout-out")}
                });
                pengine.query("repeat, output(x), sleep(1), fail");
            }
            
            function input() {
                pengine = new Pengine({
                    onanswer: function() {log(this, "input-x")},
                    onoutput: function() {log(this, "input-x")},
                    onerror:  function() {log(this, "input-x")},
                    onprompt: function() {log(this, "input-x"); pengine.input(prompt(this.data))}
                });
                pengine.query("input(X), output(X)");
            }
            
            function prolog() {
                function handleAnswer() {
                    log(this, "prolog");
                    if (this.data.success) {
                        var bindings = JSON.stringify(this.data.bindings);
                        if (confirm(bindings)) {
                            if (this.data.more) {
                                pengine.next();
                            }
                        } else {
                            pengine.stop();
                        }
                    } else {
                        alert("false");
                    }
                }
                pengine = new Pengine({
                    onanswer: handleAnswer,
                    onoutput: function() {log(this, "prolog")},
                    onerror:  function() {log(this, "prolog")},
                    onprompt: function() {log(this, "prolog")},
                    onhalted: function() {log(this, "prolog")}
                });
                query("append(A,B,[1,2,3])");
            }
            
            function query(init) {
                if (q = prompt("Enter a Prolog query", init)) {
                    pengine.query(q);
                }
            }
            
            
            function prolog2(init) {
                function handleLoaded() {
                    log(this, "prolog2");
                    if (q = prompt("Enter a Prolog query", init)) {
                        pengine.query(q);
                    }
                }
                function handleAnswer() {
                    log(this, "prolog2");
                    if (this.data.success) {
                        var bindings = JSON.stringify(this.data.bindings);
                        if (confirm(bindings)) {
                            if (this.data.more) {
                                pengine.next();
                            }
                        } else {
                            pengine.stop();
                        }
                    } else {
                        alert("false");
                    }
                }
                function handlePrompt() {
                    log(this, "prolog2");
                    if (str = prompt(this.data)) {
                        pengine.input(str);
                    }
                }
                function handleError() {
                    log(this, "prolog2");
                    alert("Error: " + this.data);
                }
                pengine = new Pengine({
                    onload: handleLoaded,
                    onanswer: handleAnswer,
                    onoutput: function() {log(this, "prolog2"); write(this, "prolog-output")},
                    onerror:  handleError,
                    onprompt: handlePrompt,
                    onhalted: function() {log(this, "prolog2")}
                });
                var p = document.getElementById("prolog-code").value; 
                pengine.load(p);
            }
            
            
            function load() {
                function handleLoaded() {
                    log(this, "load-console");
                }
                function handleError() {
                    log(this, "load-console");
                }
                pengine = new Pengine({
                    onload: handleLoaded,
                    onerror:  handleError
                });
                var program = document.getElementById("load").value;
                pengine.load(program);
            }

            function listing() {
                function handleListed() {
                    log(this, "load-console");
                }
                function handleError() {
                    log(this, "load-console");
                }
                pengine = new Pengine({
                    onlist: handleListed,
                    onerror:  handleError
                });
                pengine.listing();
            }            
                     
            
            function log(obj, id) {
                document.getElementById(id).innerHTML += JSON.stringify(obj, null, 4) + "<br />";
                $("#"+id).scrollTop($("#"+id).prop('scrollHeight'));
            }
            
            function write(obj, id) {
                document.getElementById(id).innerHTML += obj.data;
            }
            
            function clear_pre(id) {
                document.getElementById(id).innerHTML = "";
            }
            
                            
            
        </script>
    </body>
</html>